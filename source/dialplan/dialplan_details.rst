*****************
Dialplan Details
*****************


Global
-------

Global specific dialplans are global to all tennants(domains). These can be changed, however the changes apply to all tennants.

+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type        | Dialplan Detail Data                                   | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+=============================+========================================================+=======================+========================+=======================+=======================+
| condition           | ${user_exists}              | TRUE                                                   |                       |                        | 0                     | 5                     |
+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${forward_all_enabled}      | TRUE                                                   |                       |                        | 0                     | 10                    |
+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | transfer                    | ${forward_all_destination} XML ${domain_name}          |                       |                        | 0                     | 15                    |
+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+



Domain Specific
----------------

Domain specific dialplans are all the same initially but can be changed.  Those changes are per domain, thus helps FusionPBX acheive multitennancy.

Valet Parking
^^^^^^^^^^^^^^

+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type                                      | Dialplan Detail Data                                                                | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+===========================================================+=====================================================================================+=======================+========================+=======================+=======================+
| condition           | destination_number                                        | ^(park\+)?(\*59[0-9][0-9])$                                                         | never                 |                        | 0                     | 5                     |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${sip_h_Referred-By}                                      | sip:(.*)@.*                                                                         | never                 |                        | 0                     | 10                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | referred_by_user=$1                                                                 |                       |                        | 0                     | 15                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | destination_number                                        | ^(park\+)?(\*59[0-9][0-9])$                                                         | never                 |                        | 1                     | 25                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | park_in_use=false                                                                   |                       | TRUE                   | 1                     | 30                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | park_lot=$2                                                                         |                       | TRUE                   | 1                     | 35                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | destination_number                                        | ^(park\+)?(\*59[0-9][0-9])$                                                         |                       |                        | 2                     | 45                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${cond ${sip_h_Referred-By} == '' ? false : true}         | TRUE                                                                                | never                 |                        | 2                     | 50                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | park_in_use=${regex ${valet_info park@${domain_name}}|${park_lot}}                  |                       | TRUE                   | 2                     | 55                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${park_in_use}                                            | TRUE                                                                                | never                 |                        | 3                     | 65                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | transfer                                                  | ${referred_by_user} XML ${context}                                                  |                       |                        | 3                     | 70                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | set                                                       | valet_parking_timeout=180                                                           |                       |                        | 3                     | 75                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | set                                                       | valet_hold_music=${hold_music}                                                      |                       |                        | 3                     | 80                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | set                                                       | valet_parking_orbit_exten=${referred_by_user}                                       |                       |                        | 3                     | 85                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | valet_park                                                | park@${domain_name} ${park_lot}                                                     |                       |                        | 3                     | 90                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
