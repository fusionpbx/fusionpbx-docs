*****************
Dialplan Details
*****************


Global
-------

Global specific dialplans are global to all tennants(domains). These can be changed, however the changes apply to all tennants.



Caller-Details
^^^^^^^^^^^^^^^^

+---------------------+----------------------+-----------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                          | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+===============================================+=======================+========================+=======================+=======================+
| condition           |                      |                                               | never                 |                        | 0                     | 5                     |
+---------------------+----------------------+-----------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | caller_destination=${destination_number}      |                       | TRUE                   | 0                     | 10                    |
+---------------------+----------------------+-----------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | caller_id_name=${caller_id_name}              |                       | TRUE                   | 0                     | 15                    |
+---------------------+----------------------+-----------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | caller_id_number=${caller_id_number}          |                       | TRUE                   | 0                     | 20                    |
+---------------------+----------------------+-----------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Not Found
^^^^^^^^^^^


+---------------------+----------------------+-------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                                  | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+=======================================================+=======================+========================+=======================+=======================+
| condition           |                      |                                                       |                       |                        | 0                     | 5                     |
+---------------------+----------------------+-------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | call_direction=inbound                                |                       | TRUE                   | 0                     | 10                    |
+---------------------+----------------------+-------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | log                  | [inbound routes] 404 not found ${sip_network_ip}      |                       | TRUE                   | 0                     | 15                    |
+---------------------+----------------------+-------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Call Forward All
^^^^^^^^^^^^^^^^^^

+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type        | Dialplan Detail Data                                   | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+=============================+========================================================+=======================+========================+=======================+=======================+
| condition           | ${user_exists}              | TRUE                                                   |                       |                        | 0                     | 5                     |
+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${forward_all_enabled}      | TRUE                                                   |                       |                        | 0                     | 10                    |
+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | transfer                    | ${forward_all_destination} XML ${domain_name}          |                       |                        | 0                     | 15                    |
+---------------------+-----------------------------+--------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Intercept Ext Polycom
^^^^^^^^^^^^^^^^^^^^^^

+---------------------+----------------------+---------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data            | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+=================================+=======================+========================+=======================+=======================+
| condition           | destination_number   | ^\*97(\d+)$                     |                       |                        | 0                     | 5                     |
+---------------------+----------------------+---------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | answer               |                                 |                       |                        | 0                     | 10                    |
+---------------------+----------------------+---------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | lua                  | intercept.lua $1                |                       |                        | 0                     | 15                    |
+---------------------+----------------------+---------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Talking Clock Date
^^^^^^^^^^^^^^^^^^^

+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                                              | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+===================================================================+=======================+========================+=======================+=======================+
| condition           | destination_number   | ^\*9171$                                                          |                       |                        | 0                     | 5                     |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | answer               |                                                                   |                       |                        | 0                     | 10                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | sleep                | 1000                                                              |                       |                        | 0                     | 15                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | say                  | ${default_language} CURRENT_DATE pronounced ${strepoch()}         |                       |                        | 0                     | 20                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | hangup               |                                                                   |                       |                        | 0                     | 25                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Talking Clock Date And Time
^^^^^^^^^^^^^^^^^^^^^^^^^^^^


+---------------------+----------------------+-------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                                                    | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+=========================================================================+=======================+========================+=======================+=======================+
| condition           | destination_number   | ^\*9172$                                                                |                       |                        | 0                     | 5                     |
+---------------------+----------------------+-------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | answer               |                                                                         |                       |                        | 0                     | 10                    |
+---------------------+----------------------+-------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | sleep                | 1000                                                                    |                       |                        | 0                     | 15                    |
+---------------------+----------------------+-------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | say                  | ${default_language} CURRENT_DATE_TIME pronounced ${strepoch()}          |                       |                        | 0                     | 20                    |
+---------------------+----------------------+-------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | hangup               |                                                                         |                       |                        | 0                     | 25                    |
+---------------------+----------------------+-------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Outbound Route Example
^^^^^^^^^^^^^^^^^^^^^^^^


+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                                             | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+==================================================================+=======================+========================+=======================+=======================+
| condition           | ${user_exists}       | FALSE                                                            |                       |                        | 0                     | 0                     |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | destination_number   | ^\+?1?(\d{10})$                                                  |                       |                        | 0                     | 10                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | sip_h_X-accountcode=${accountcode}                               |                       |                        | 0                     | 20                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | export               | call_direction=outbound                                          |                       |                        | 0                     | 30                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | unset                | call_timeout                                                     |                       |                        | 0                     | 40                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | hangup_after_bridge=true                                         |                       |                        | 0                     | 50                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | effective_caller_id_name=${outbound_caller_id_name}              |                       |                        | 0                     | 60                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | effective_caller_id_number=${outbound_caller_id_number}          |                       |                        | 0                     | 70                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | inherit_codec=true                                               |                       |                        | 0                     | 80                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | ignore_display_updates=true                                      |                       |                        | 0                     | 90                    |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | callee_id_number=$1                                              |                       |                        | 0                     | 100                   |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                  | continue_on_fail=true                                            |                       |                        | 0                     | 110                   |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | bridge               | sofia/gateway/72d236fb-945b-4c86-8e75-af7c6bcf2862/$1            |                       |                        | 0                     | 120                   |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | bridge               | sofia/gateway/72d236fb-945b-4c86-8e75-af7c6bcf2862/$1            |                       |                        | 0                     | 130                   |
+---------------------+----------------------+------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Talking Clock Time
^^^^^^^^^^^^^^^^^^^^

+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                                              | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+===================================================================+=======================+========================+=======================+=======================+
| condition           | destination_number   | ^\*9170$                                                          |                       |                        | 0                     | 5                     |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | answer               |                                                                   |                       |                        | 0                     | 10                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | sleep                | 1000                                                              |                       |                        | 0                     | 15                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | say                  | ${default_language} CURRENT_TIME pronounced ${strepoch()}         |                       |                        | 0                     | 20                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | hangup               |                                                                   |                       |                        | 0                     | 25                    |
+---------------------+----------------------+-------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+






Domain Specific
----------------

Domain specific dialplans are all the same initially but can be changed.  Those changes are per domain, thus helps FusionPBX acheive multitennancy.


Valet Park In
^^^^^^^^^^^^^^^

+---------------------+----------------------+-------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                      | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+===========================================+=======================+========================+=======================+=======================+
| condition           | destination_number   | ^(park\+)?(\*5900)$                       |                       |                        | 0                     | 5                     |
+---------------------+----------------------+-------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | valet_park           | park@${domain_name} auto in 5901 5999     |                       |                        | 0                     | 10                    |
+---------------------+----------------------+-------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Valet Park Out
^^^^^^^^^^^^^^^

+---------------------+----------------------+-------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type | Dialplan Detail Data                            | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+======================+=================================================+=======================+========================+=======================+=======================+
| condition           | destination_number   | ^(park\+)?\*(59[0-9][0-9])$                     |                       |                        | 0                     | 5                     |
+---------------------+----------------------+-------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | answer               |                                                 |                       |                        | 0                     | 10                    |
+---------------------+----------------------+-------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | valet_park           | park@${domain_name} $2                          |                       |                        | 0                     | 15                    |
+---------------------+----------------------+-------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+


Valet Parking
^^^^^^^^^^^^^^

+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| Dialplan Detail Tag | Dialplan Detail Type                                      | Dialplan Detail Data                                                                | Dialplan Detail Break | Dialplan Detail Inline | Dialplan Detail Group | Dialplan Detail Order |
+=====================+===========================================================+=====================================================================================+=======================+========================+=======================+=======================+
| condition           | destination_number                                        | ^(park\+)?(\*59[0-9][0-9])$                                                         | never                 |                        | 0                     | 5                     |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${sip_h_Referred-By}                                      | sip:(.*)@.*                                                                         | never                 |                        | 0                     | 10                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | referred_by_user=$1                                                                 |                       |                        | 0                     | 15                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | destination_number                                        | ^(park\+)?(\*59[0-9][0-9])$                                                         | never                 |                        | 1                     | 25                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | park_in_use=false                                                                   |                       | TRUE                   | 1                     | 30                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | park_lot=$2                                                                         |                       | TRUE                   | 1                     | 35                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | destination_number                                        | ^(park\+)?(\*59[0-9][0-9])$                                                         |                       |                        | 2                     | 45                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${cond ${sip_h_Referred-By} == '' ? false : true}         | TRUE                                                                                | never                 |                        | 2                     | 50                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | set                                                       | park_in_use=${regex ${valet_info park@${domain_name}}|${park_lot}}                  |                       | TRUE                   | 2                     | 55                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| condition           | ${park_in_use}                                            | TRUE                                                                                | never                 |                        | 3                     | 65                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| action              | transfer                                                  | ${referred_by_user} XML ${context}                                                  |                       |                        | 3                     | 70                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | set                                                       | valet_parking_timeout=180                                                           |                       |                        | 3                     | 75                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | set                                                       | valet_hold_music=${hold_music}                                                      |                       |                        | 3                     | 80                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | set                                                       | valet_parking_orbit_exten=${referred_by_user}                                       |                       |                        | 3                     | 85                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
| anti-action         | valet_park                                                | park@${domain_name} ${park_lot}                                                     |                       |                        | 3                     | 90                    |
+---------------------+-----------------------------------------------------------+-------------------------------------------------------------------------------------+-----------------------+------------------------+-----------------------+-----------------------+
